---
phase: 04-missing-implementation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified: [src/Validation/CrossApplicationValidator.cs, src/Services/TextInjectionService.cs]
autonomous: true
must_haves:
  truths:
    - "Cross-application text injection validation works across all target applications"
    - "Automated tests provide clear pass/fail results per application"
    - "Text appears at exact cursor position in target applications"
  artifacts:
    - path: "src/Validation/CrossApplicationValidator.cs"
      provides: "Comprehensive cross-application validation framework"
      min_lines: 150
    - path: "src/Services/TextInjectionService.cs"
      provides: "Enhanced text injection with validation support"
      contains: "ValidateCrossApplicationInjectionAsync"
  key_links:
    - from: "src/Validation/CrossApplicationValidator.cs"
      to: "src/Services/TextInjectionService.cs"
      via: "dependency injection"
      pattern: "ITextInjectionService"
    - from: "src/Validation/CrossApplicationValidator.cs"
      to: "Target applications (browsers, IDEs, Office, Notepad++, terminal)"
      via: "Windows UI Automation"
      pattern: "FindWindow.*Process.*MainWindowTitle"
---

<objective>
Implement comprehensive cross-application text injection validation to verify CORE-03 requirement completeness.

Purpose: Ensure text injection works reliably across all target Windows applications with automated testing providing clear pass/fail results.
Output: Automated validation framework with comprehensive test coverage and detailed reporting.
</objective>

<execution_context>
@~/.config/opencode/get-shit-done/workflows/execute-plan.md
@~/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-missing-implementation/04-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Create CrossApplicationValidator</name>
  <files>src/Validation/CrossApplicationValidator.cs</files>
  <action>
Create CrossApplicationValidator class with:
- Constructor accepting ITextInjectionService and ILogger
- ValidateCrossApplicationInjectionAsync method that tests against target applications
- Target apps: Chrome, Firefox, Edge, Visual Studio, Word, Notepad++, Windows Terminal
- For each app: launch/find window, set focus, inject test text, verify text appears at cursor position
- Return ValidationResult with per-app pass/fail status, error details, and compatibility score
- Use Windows UI Automation to find and verify text content at cursor position
- Include retry logic for timing issues and focus management
  </action>
  <verify>
dotnet build --no-restore succeeds
</verify>
  <done>CrossApplicationValidator created with comprehensive testing framework</done>
</task>

<task type="auto">
  <name>Enhance TextInjectionService with Validation Support</name>
  <files>src/Services/TextInjectionService.cs</files>
  <action>
Enhance existing TextInjectionService:
- Add ValidateInjectionAsync method for validation-specific testing
- Add GetInjectionAccuracyAsync method to measure text placement accuracy
- Add GetSupportedApplicationsAsync method to return compatibility matrix
- Implement focus verification before injection (IsTargetWindowFocused)
- Add injection timing metrics for performance analysis
- Ensure error handling provides detailed failure reasons for validation
- Maintain backward compatibility with existing injection methods
  </action>
  <verify>
dotnet build --no-restore succeeds
</verify>
  <done>TextInjectionService enhanced with validation capabilities</done>
</task>

</tasks>

<verification>
- CrossApplicationValidator validates text injection across 7 target applications
- Each test provides clear pass/fail result with accuracy metrics
- Injection validation works with Unicode characters and special characters
- Validation framework handles edge cases (focus loss, timing issues, permissions)
</verification>

<success_criteria>
- Automated validation confirms text injection works across all target applications
- Validation results show 95%+ success rate across application categories
- Clear pass/fail reporting enables identification of any compatibility issues
- Validation framework can be extended for additional applications
</success_criteria>

<output>
After completion, create `.planning/phases/04-missing-implementation/04-01-SUMMARY.md`
</output>