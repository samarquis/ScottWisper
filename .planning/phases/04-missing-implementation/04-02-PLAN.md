---
phase: 04-missing-implementation
plan: 02
type: execute
wave: 1
depends_on: []
files_modified: [src/UI/SettingsWindow.xaml, src/UI/SettingsWindow.xaml.cs, src/ViewModels/SettingsViewModel.cs]
autonomous: true
must_haves:
  truths:
    - "Settings UI provides complete hotkey and audio device configuration interface"
    - "All settings changes persist and restore correctly"
    - "UI updates in real-time when settings change"
  artifacts:
    - path: "src/UI/SettingsWindow.xaml"
      provides: "Complete settings UI layout"
      contains: "AudioDeviceSection, HotkeySection, APISection"
    - path: "src/ViewModels/SettingsViewModel.cs"
      provides: "Settings data binding and persistence"
      min_lines: 200
    - path: "src/UI/SettingsWindow.xaml.cs"
      provides: "Settings window code-behind with event handling"
      contains: "InitializeComponent, OnLoaded"
  key_links:
    - from: "src/UI/SettingsWindow.xaml"
      to: "src/ViewModels/SettingsViewModel.cs"
      via: "WPF data binding"
      pattern: "DataContext.*SettingsViewModel"
    - from: "src/ViewModels/SettingsViewModel.cs"
      to: "src/Services/SettingsService.cs"
      via: "dependency injection"
      pattern: "ISettingsService"
---

<objective>
Complete settings management UI to fully satisfy SYS-02 requirement with comprehensive configuration interface.

Purpose: Provide users with complete control over hotkeys, audio devices, and API settings through professional interface.
Output: Polished settings window with real-time updates, validation, and persistent configuration.
</objective>

<execution_context>
@~/.config/opencode/get-shit-done/workflows/execute-plan.md
@~/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-missing-implementation/04-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Complete SettingsWindow XAML Layout</name>
  <files>src/UI/SettingsWindow.xaml</files>
  <action>
Enhance SettingsWindow.xaml with complete UI sections:
- TabControl with sections: General, Audio, Hotkeys, API, Advanced
- Audio section: Input device ComboBox with device detection, test microphone button, volume meter
- Hotkeys section: Recording hotkey recorder with conflict detection, profile management
- API section: API key input with validation, usage display, tier warnings
- General section: Startup options, update settings, about section
- Advanced section: Debug logging, performance metrics, reset options
- Use modern WPF styling with consistent margins, spacing, and responsive layout
- Include ToolTips and validation error display
- Add status indicators for real-time feedback
  </action>
  <verify>
dotnet build --no-restore succeeds
</verify>
  <done>SettingsWindow XAML complete with all configuration sections</done>
</task>

<task type="auto">
  <name>Implement SettingsViewModel with Data Binding</name>
  <files>src/ViewModels/SettingsViewModel.cs</files>
  <action>
Create complete SettingsViewModel implementing INotifyPropertyChanged:
- Properties for all settings: SelectedInputDevice, RecordingHotkey, APIKey, etc.
- Commands: SaveCommand, ResetCommand, TestAudioCommand, RecordHotkeyCommand
- Methods: LoadSettingsAsync, SaveSettingsAsync, ValidateSettingsAsync
- Real-time device list updates via AudioDeviceService events
- Hotkey recording with conflict detection and validation
- API key validation and usage tracking integration
- Async/await patterns for all I/O operations
- Error handling with user-friendly error messages
- Support for settings change notifications and auto-save
  </action>
  <verify>
dotnet build --no-restore succeeds
</verify>
  <done>SettingsViewModel complete with full data binding support</done>
</task>

<task type="auto">
  <name>Implement SettingsWindow Code-Behind</name>
  <files>src/UI/SettingsWindow.xaml.cs</files>
  <action>
Complete SettingsWindow.xaml.cs with:
- Constructor injection for IServiceProvider and required services
- WindowLoaded event handler to initialize data context and load settings
- Event handlers for UI-specific interactions (window closing, resize, etc.)
- Integration with hotkey recording UI (visual feedback during recording)
- Audio device testing integration with real-time visual feedback
- Settings validation display with error highlighting
- Window positioning and state management (remember size/position)
- Integration with system tray and main application flow
- Proper cleanup and resource disposal on window close
  </action>
  <verify>
dotnet build --no-restore succeeds
</verify>
  <done>SettingsWindow code-behind complete with all event handling</done>
</task>

</tasks>

<verification>
- Settings window opens and displays all configuration sections properly
- Audio device selection shows available devices and allows testing
- Hotkey recording interface captures key combinations and detects conflicts
- API key input validates format and shows usage statistics
- Settings changes persist across application restarts
- UI updates in real-time when settings change from other sources
- Window remembers position and size between sessions
</verification>

<success_criteria>
- All SYS-02 requirement elements fully implemented in settings UI
- Users can configure hotkeys, audio devices, and API settings through intuitive interface
- Settings persistence works reliably with proper validation
- Settings UI integrates seamlessly with application workflow
- Professional appearance consistent with modern Windows applications
</success_criteria>

<output>
After completion, create `.planning/phases/04-missing-implementation/04-02-SUMMARY.md`
</output>