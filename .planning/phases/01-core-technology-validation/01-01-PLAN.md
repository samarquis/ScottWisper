---
phase: 01-core-technology-validation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified: [ScottWisper.csproj, App.xaml.cs, MainWindow.xaml, MainWindow.xaml.cs, HotkeyService.cs]
autonomous: true
must_haves:
  truths:
    - "WinUI 3 application launches successfully on Windows 10/11"
    - "Application runs in system tray with minimal resource usage"
    - "Global hotkey registration works without administrator privileges"
  artifacts:
    - path: "ScottWisper.csproj"
      provides: "WinUI 3 project configuration with .NET 8"
      contains: "WinUI"
    - path: "App.xaml.cs"
      provides: "Application entry point and system tray setup"
      min_lines: 20
    - path: "HotkeyService.cs"
      provides: "Global hotkey registration using Windows API"
      contains: "RegisterHotKey"
  key_links:
    - from: "App.xaml.cs"
      to: "HotkeyService.cs"
      via: "service instantiation"
      pattern: "HotkeyService"
---

<objective>
Establish the foundational WinUI 3 application with system-wide hotkey registration capability.

Purpose: Create the basic Windows application infrastructure that can run as a background process and respond to global hotkey events, forming the foundation for speech dictation activation.
Output: Working WinUI 3 application with system tray presence and global hotkey handling.
</objective>

<execution_context>
@~/.config/opencode/get-shit-done/workflows/execute-plan.md
@~/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
</context>

<tasks>

<task type="auto">
  <name>Setup WinUI 3 project structure with .NET 8</name>
  <files>ScottWisper.csproj, App.xaml, App.xaml.cs, MainWindow.xaml, MainWindow.xaml.cs</files>
  <action>
Create a new WinUI 3 desktop application targeting .NET 8:
1. Create ScottWisper.csproj with WinUI 3 SDK reference and .NET 8 target framework
2. Setup basic App.xaml with application resources and startup configuration
3. Implement App.xaml.cs with OnLaunched method and basic window management
4. Create MainWindow.xaml with minimal UI (can be hidden initially)
5. Implement MainWindow.xaml.cs with basic window functionality
6. Ensure the application can be built and runs successfully
7. Add package references for WinUI 3 and required dependencies

Configuration requirements:
- Target .NET 8 (net8.0-windows)
- Use WindowsAppSDK 1.4+ for WinUI 3
- Configure for both Windows 10 and Windows 11 compatibility
- Set application to minimize to system tray on startup
</action>
  <verify>dotnet build succeeds and application launches without errors</verify>
  <done>WinUI 3 application builds and launches correctly on Windows</done>
</task>

<task type="auto">
  <name>Implement system-wide hotkey registration</name>
  <files>HotkeyService.cs, App.xaml.cs</files>
  <action>
Create a global hotkey registration system:
1. Create HotkeyService.cs class using Windows API (RegisterHotKey/UnregisterHotKey)
2. Implement hotkey registration for Ctrl+Win+Shift+V (configurable later)
3. Add proper Windows message handling for hotkey detection
4. Integrate hotkey service into App.xaml.cs application lifecycle
5. Ensure hotkey works when application is in background/system tray
6. Add error handling for hotkey registration failures
7. Test hotkey registration without requiring administrator privileges
8. Add proper cleanup on application exit

Technical implementation:
- Use P/Invoke for Windows API calls (user32.dll)
- Implement Windows message loop override for WM_HOTKEY handling
- Add IDisposable pattern for proper resource cleanup
- Store hotkey ID to avoid conflicts with other applications
</action>
  <verify>Global hotkey triggers event handler when application is running in background</verify>
  <done>System-wide hotkey registration works reliably and activates event handler</done>
</task>

</tasks>

<verification>
1. Application builds without errors or warnings
2. Application launches and appears in system tray
3. Global hotkey (Ctrl+Win+Shift+V) triggers event handler when pressed
4. Application runs without requiring administrator privileges
5. Application can be closed normally without hanging
</verification>

<success_criteria>
- WinUI 3 application successfully launches on Windows 10/11
- Global hotkey registration works system-wide
- Application runs as background process with system tray presence
- No administrator privileges required for hotkey registration
- Application handles startup and shutdown gracefully
</success_criteria>

<output>
After completion, create `.planning/phases/01-core-technology-validation/01-01-SUMMARY.md`
</output>