---
phase: 02-windows-integration
plan: 08
type: execute
wave: 2
depends_on: ["01-core-technology-validation", "02-windows-integration-03", "02-windows-integration-04", "02-windows-integration-07"]
files_modified: [App.xaml.cs, MainWindow.xaml.cs, SystemTrayService.cs]
autonomous: true
must_haves:
  truths:
    - "System tray provides complete application control"
    - "Application lifecycle is properly managed"
    - "System tray responds to all user interactions"
    - "CPU and memory usage remain minimal during background operation"
  artifacts:
    - path: "SystemTrayService.cs"
      provides: "Enhanced system tray with status indicators"
      contains: "UpdateStatus"
      min_lines: 40
    - path: "App.xaml.cs"
      provides: "Application lifecycle integration"
      contains: "SystemTrayService"
  key_links:
    - from: "App.xaml.cs"
      to: "SystemTrayService.cs"
      via: "service registration"
      pattern: "services.AddTransient"
    - from: "MainWindow.xaml.cs"
      to: "SystemTrayService.cs"
      via: "status synchronization"
      pattern: "UpdateStatus"
---

<objective>
Complete system tray integration with enhanced status indicators and comprehensive application lifecycle management.

Purpose: Transform the application into a professional background service with full system tray control and status management.
Output: Complete system tray integration with context menus, status indicators, and background operation management.
</objective>

<execution_context>
@~/.config/opencode/get-shit-done/workflows/execute-plan.md
@~/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/02-windows-integration/02-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Integrate SystemTrayService with application lifecycle</name>
  <files>App.xaml.cs, MainWindow.xaml.cs</files>
  <action>
Integrate system tray service with application startup and management:
1. Register SystemTrayService in dependency injection
2. Initialize system tray on application startup
3. Handle system tray events in application logic
4. Connect tray menu actions to existing functionality
5. Implement proper service cleanup on shutdown
6. Add error handling for tray initialization failures
7. Connect tray status to transcription service states

Integration points:
- Connect Start/Stop dictation to HotkeyService
- Connect Settings to future settings window
- Connect Exit to proper application shutdown
- Sync status indicators with transcription states
- Handle tray double-click for window show/hide
</action>
  <verify>System tray is fully integrated and controls all application functions</verify>
  <done>SystemTrayService is seamlessly integrated with application lifecycle</done>
</task>

<task type="auto">
  <name>Enhance SystemTrayService with status indicators</name>
  <files>SystemTrayService.cs</files>
  <action>
Enhance SystemTrayService with comprehensive status management:
1. Add status indicators (idle, recording, processing, error)
2. Implement balloon notifications for important events
3. Add tooltip with current status and usage information
4. Create status-aware icon switching
5. Add additional context menu items
6. Implement status change notifications

Enhanced menu items:
- Start/Stop Dictation
- Status (current mode, usage stats)
- Settings/Configuration
- Help/Documentation
- Exit Application

Status indicators:
- Green icon: Ready/idle
- Red icon: Recording
- Yellow icon: Processing
- Gray icon: Error/offline
</action>
  <verify>SystemTrayService provides complete status indication and control</verify>
  <done>Enhanced system tray offers professional user experience</done>
</task>

</tasks>

<verification>
1. SystemTrayService is properly registered in dependency injection
2. System tray initializes on application startup
3. All tray menu actions connect to application functions
4. Status indicators change correctly based on application state
5. Balloon notifications work for important events
6. Tooltip displays current status and usage information
7. Context menu provides complete application control
8. Service cleanup occurs properly on application shutdown
9. Error handling covers tray initialization failures
</verification>

<success_criteria>
- Application runs continuously as background process with system tray presence
- Complete application control available through system tray interface
- Status indicators provide clear feedback about application state
- Resource usage remains minimal during idle background operation
- User can start/stop dictation, access settings, and exit via system tray
- Application never appears in taskbar during normal operation
- Integration with existing services (hotkey, transcription) is seamless
- Professional status indicators synchronize with application states
</success_criteria>

<output>
After completion, create `.planning/phases/02-windows-integration/02-08-SUMMARY.md`
</output>