---
phase: 02-windows-integration
plan: 16
type: execute
wave: 3
depends_on: ["01-core-technology-validation", "02-windows-integration-13", "02-windows-integration-14", "02-windows-integration-15"]
files_modified: [App.xaml.cs, MainWindow.xaml.cs, SettingsService.cs]
autonomous: true
must_haves:
  truths:
    - "All services integrate with SettingsService and apply changes immediately"
    - "Real-time settings application works without requiring restart"
    - "Settings validation prevents configuration errors"
    - "Settings backup and restore functionality works correctly"
  artifacts:
    - path: "SettingsService.cs"
      provides: "Enhanced settings with advanced features"
      contains: "backup restore"
      min_lines: 40
    - path: "App.xaml.cs"
      provides: "Settings integration with application startup"
      contains: "SettingsService"
  key_links:
    - from: "App.xaml.cs"
      to: "SettingsService.cs"
      via: "service registration"
      pattern: "SettingsService"
    - from: "MainWindow.xaml.cs"
      to: "SettingsService.cs"
      via: "settings application"
      pattern: "SettingsService"
---

<objective>
Complete settings system integration with all application services and enhance with advanced features.

Purpose: Integrate comprehensive settings management across all application components with real-time application, backup/restore, and advanced configuration features.
Output: Complete settings system with full service integration, real-time application, and professional configuration management.
</objective>

<execution_context>
@~/.config/opencode/get-shit-done/workflows/execute-plan.md
@~/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/02-windows-integration/02-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Add settings integration with application services</name>
  <files>App.xaml.cs, MainWindow.xaml.cs, SettingsService.cs</files>
  <action>
Integrate settings system with all application components:
1. Register SettingsService in dependency injection
2. Connect all services to SettingsService for configuration
3. Implement real-time settings application
4. Add settings change notifications
5. Create settings validation and error handling
6. Implement settings reset and migration
7. Add settings backup and restore functionality

Service integration:
- AudioCaptureService: device settings, format options
- WhisperService: API configuration, model selection
- HotkeyService: configurable hotkey combinations
- FeedbackService: user preference for feedback types
- SystemTrayService: startup behavior, UI options
- TextInjectionService: injection method preferences
- AudioVisualizer: visualization preferences

Real-time application:
- Apply changes without application restart
- Validate settings before application
- Rollback on configuration errors
- Notify users of required restarts
- Maintain service consistency
</action>
  <verify>All services properly use SettingsService and apply changes in real-time</verify>
  <done>Complete settings integration with immediate application of changes</done>
</task>

<task type="auto">
  <name>Enhance SettingsService with advanced features</name>
  <files>SettingsService.cs</files>
  <action>
Enhance SettingsService with advanced configuration management:
1. Add comprehensive configuration categories and options
2. Implement advanced validation and migration logic
3. Add settings backup and restore functionality
4. Create configuration import/export capabilities
5. Add user profile support for multiple configurations
6. Implement configuration versioning and upgrade paths

Advanced features:
- Comprehensive configuration categories
- Advanced validation and error handling
- Settings backup and restore
- Configuration import/export
- User profile support
- Configuration versioning
- Migration logic for upgrades
</action>
  <verify>Enhanced SettingsService provides comprehensive configuration management</verify>
  <done>Advanced settings system offers professional configuration capabilities</done>
</task>

</tasks>

<verification>
1. SettingsService is properly registered in dependency injection
2. All application services connect to SettingsService for configuration
3. Real-time settings application works without restart
4. Settings validation prevents configuration errors
5. Settings change notifications work correctly
6. Settings reset and migration function properly
7. Backup and restore functionality works reliably
8. Configuration import/export operates correctly
9. User profile support manages multiple configurations
10. Configuration versioning handles upgrades smoothly
11. Migration logic preserves user settings during updates
12. Error handling provides helpful feedback for configuration issues
</verification>

<success_criteria>
- Complete settings management with secure persistence of user preferences
- Real-time application of most settings without requiring application restart
- All services integrate with SettingsService and apply changes immediately
- Comprehensive validation prevents configuration errors
- Settings backup, restore, and import/export functionality works reliably
- User profile support manages multiple configurations effectively
- Configuration versioning and migration handle upgrades smoothly
- Professional integration with all application services
- Minimal performance impact with efficient configuration loading/saving
- Advanced features provide professional configuration management capabilities
</success_criteria>

<output>
After completion, create `.planning/phases/02-windows-integration/02-16-SUMMARY.md`
</output>