---
phase: 02-windows-integration
plan: 14
type: execute
wave: 3
depends_on: ["01-core-technology-validation", "02-windows-integration-09", "02-windows-integration-10", "02-windows-integration-13"]
files_modified: [SettingsService.cs, SettingsWindow.xaml.cs, AudioDeviceService.cs]
autonomous: true
must_haves:
  truths:
    - "Audio device selection works with real-time testing and validation"
    - "Device management provides comprehensive audio control"
    - "SYS-03 audio device selection has complete coverage"
    - "Device testing includes level meters and compatibility modes"
  artifacts:
    - path: "AudioDeviceService.cs"
      provides: "Audio device management and testing"
      contains: "NAudio"
      min_lines: 80
    - path: "SettingsWindow.xaml.cs"
      provides: "Audio device UI integration"
      contains: "device selection"
  key_links:
    - from: "SettingsWindow.xaml.cs"
      to: "AudioDeviceService.cs"
      via: "device selection"
      pattern: "AudioDeviceService"
    - from: "SettingsWindow.xaml.cs"
      to: "SettingsService.cs"
      via: "settings persistence"
      pattern: "SettingsService"
---

<objective>
Implement comprehensive audio device management with real-time testing, device enumeration, and professional user interface integration.

Purpose: Provide professional audio device selection with testing capabilities, device compatibility management, and complete SYS-03 coverage.
Output: Complete audio device management system with real-time testing, level meters, and comprehensive device control.
</objective>

<execution_context>
@~/.config/opencode/get-shit-done/workflows/execute-plan.md
@~/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/02-windows-integration/02-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Implement audio device selection and testing</name>
  <files>SettingsService.cs, SettingsWindow.xaml.cs, AudioDeviceService.cs</files>
  <action>
Create audio device management and testing capabilities:
1. Implement AudioDeviceService using NAudio
2. Add device enumeration for input/output devices
3. Create device testing with level meters
4. Implement device change detection and notifications
5. Add default device fallback logic
6. Create audio format configuration options
7. Add device-specific settings and compatibility modes

Device management features:
- Real-time device detection and listing
- Audio level testing with visual feedback
- Sample rate and format selection
- Default device management
- Device compatibility information
- Hot-plug device change handling
- Audio quality testing and recommendations

Settings integration:
- Persistent device selection
- Device-specific preferences
- Automatic fallback configuration
- Quality vs performance trade-offs
- Multi-device support scenarios

SYS-03 complete coverage:
- Comprehensive input device enumeration
- Output device management for feedback
- Device testing with level meters
- Format compatibility validation
- Driver compatibility checking
- Multi-channel device support
- Professional audio equipment support
</action>
  <verify>Audio device selection works correctly with testing capabilities</verify>
  <done>Complete audio device management with professional interface</done>
</task>

</tasks>

<verification>
1. AudioDeviceService enumerates all available input/output devices
2. Device testing provides real-time audio level feedback
3. Level meters show accurate audio levels during testing
4. Device change detection works for hot-plug scenarios
5. Default device fallback logic handles device disconnection
6. Audio format configuration supports various sample rates
7. Device compatibility modes handle problematic hardware
8. Settings persistence remembers device preferences
9. Multi-device scenarios are properly handled
10. SYS-03 audio device selection provides complete coverage
11. Professional audio equipment is supported
12. Driver compatibility checking prevents issues
</verification>

<success_criteria>
- Complete audio device management with comprehensive enumeration
- Real-time device testing with visual level meters
- Automatic fallback logic handles device disconnections gracefully
- Device-specific preferences are properly persisted
- Hot-plug device changes are detected and handled
- Audio format configuration supports professional requirements
- Device compatibility modes ensure broad hardware support
- SYS-03 requirement is fully satisfied with complete coverage
- Professional audio equipment works correctly
- Multi-device scenarios are supported
- User interface provides intuitive device management
- Integration with SettingsService ensures persistence
</success_criteria>

<output>
After completion, create `.planning/phases/02-windows-integration/02-14-SUMMARY.md`
</output>