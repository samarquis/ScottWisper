---
phase: 02-windows-integration
plan: 09
type: execute
wave: 2
depends_on: ["01-core-technology-validation", "02-windows-integration-08"]
files_modified: [SettingsService.cs, WhisperKey.csproj, appsettings.json]
autonomous: true
must_haves:
  truths:
    - "Core settings management system is implemented"
    - "Basic user preferences persist across application restarts"
    - "Configuration framework supports secure data storage"
    - "System provides foundation for enhanced settings features"
  artifacts:
    - path: "SettingsService.cs"
      provides: "Core configuration management with persistence"
      contains: "IOptions"
      min_lines: 60
    - path: "appsettings.json"
      provides: "Default configuration structure"
      contains: "\"Audio\""
    - path: "WhisperKey.csproj"
      provides: "Required configuration packages"
      contains: "Microsoft.Extensions.Configuration"
  key_links:
    - from: "SettingsService.cs"
      to: "appsettings.json"
      via: "configuration loading"
      pattern: "Configuration"
    - from: "SettingsService.cs"
      to: "WhisperKey.csproj"
      via: "package dependency"
      pattern: "Microsoft.Extensions.Configuration"
---

<objective>
Implement core settings management system with basic configuration persistence and secure data storage.

Purpose: Create the foundation for professional configuration management with essential settings categories and secure persistence.
Output: Core SettingsService with .NET 8 Configuration integration and basic settings structure.
</objective>

<execution_context>
@~/.config/opencode/get-shit-done/workflows/execute-plan.md
@~/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/02-windows-integration/02-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Create core SettingsService with .NET 8 Configuration</name>
  <files>SettingsService.cs, WhisperKey.csproj, appsettings.json</files>
  <action>
Implement core settings management using .NET 8 Configuration:
1. Add Microsoft.Extensions.Configuration NuGet packages
2. Create appsettings.json with basic configuration structure
3. Implement SettingsService using Options pattern
4. Add basic strongly-typed configuration classes
5. Implement JSON serialization for user preferences
6. Add basic encryption for sensitive data (API keys)
7. Create basic configuration validation

Core configuration categories:
- Audio: basic input device selection
- Transcription: provider, basic API settings
- Hotkeys: basic toggle recording hotkey
- UI: basic feedback preferences

Basic security features:
- Windows Data Protection API for API key encryption
- User-specific storage in %APPDATA%
- Basic configuration file permissions
</action>
  <verify>Core SettingsService compiles and provides basic configuration management</verify>
  <done>Core SettingsService offers secure configuration persistence</done>
</task>

</tasks>

<verification>
1. Microsoft.Extensions.Configuration packages are properly installed
2. SettingsService implements Options pattern correctly
3. appsettings.json provides basic configuration structure
4. Strongly-typed configuration classes are implemented
5. JSON serialization works for user preferences
6. Basic encryption is implemented for sensitive data
7. Configuration validation handles basic scenarios
8. User-specific storage location is properly configured
</verification>

<success_criteria>
- Core settings management system is implemented
- Basic user preferences persist across application restarts
- Configuration framework supports secure data storage
- System provides foundation for enhanced settings features
- Security best practices are implemented for sensitive data
- Configuration structure supports future expansion
- .NET 8 Configuration patterns are properly utilized
</success_criteria>

<output>
After completion, create `.planning/phases/02-windows-integration/02-09-SUMMARY.md`
</output>