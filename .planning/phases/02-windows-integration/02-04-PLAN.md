---
phase: 02-windows-integration
plan: 04
type: execute
wave: 1
depends_on: ["01-core-technology-validation"]
files_modified: [ScottWisper.csproj, SystemTrayService.cs]
autonomous: true
must_haves:
  truths:
    - "System tray integration is implemented with basic functionality"
    - "Application icon appears in system tray when running"
    - "Context menu provides essential application controls"
    - "Basic cleanup and resource management are implemented"
  artifacts:
    - path: "SystemTrayService.cs"
      provides: "Core system tray functionality"
      contains: "NotifyIcon"
      min_lines: 60
    - path: "ScottWisper.csproj"
      provides: "Required NuGet packages for system tray"
      contains: "H.NotifyIcon"
  key_links:
    - from: "SystemTrayService.cs"
      to: "ScottWisper.csproj"
      via: "package reference"
      pattern: "H.NotifyIcon"
---

<objective>
Implement core system tray integration with essential functionality for background operation.

Purpose: Create the foundation for system tray presence with basic icon display and context menu controls.
Output: System tray service with NotifyIcon integration and essential menu items.
</objective>

<execution_context>
@~/.config/opencode/get-shit-done/workflows/execute-plan.md
@~/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/02-windows-integration/02-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Add H.NotifyIcon.Wpf NuGet package</name>
  <files>ScottWisper.csproj</files>
  <action>
Add system tray functionality through modern WPF NotifyIcon:
1. Add H.NotifyIcon.Wpf v2.4.1+ package reference
2. Ensure compatibility with .NET 8 and WPF
3. Configure package for Windows 10/11 compatibility
4. Update project file with proper package versioning
5. Restore packages and verify no conflicts

Package requirements:
- H.NotifyIcon.Wpf for modern WPF system tray integration
- Support for custom icons and context menus
- .NET 8 compatible version
- MIT License for commercial use
</action>
  <verify>dotnet restore succeeds and H.NotifyIcon.Wpf is properly referenced</verify>
  <done>System tray package is installed and ready for integration</done>
</task>

<task type="auto">
  <name>Implement basic SystemTrayService</name>
  <files>SystemTrayService.cs</files>
  <action>
Create core SystemTrayService.cs with essential functionality:
1. Implement service class with IDisposable pattern
2. Create notify icon with basic application icon
3. Implement essential context menu items
4. Add basic tooltip information
5. Include proper cleanup and resource management

Essential menu items:
- Start/Stop Dictation
- Settings
- Exit Application

Basic functionality:
- Icon display in system tray
- Context menu with essential controls
- Basic tooltip showing application status
</action>
  <verify>SystemTrayService compiles and provides basic tray functionality</verify>
  <done>Core system tray service is implemented with essential controls</done>
</task>

</tasks>

<verification>
1. H.NotifyIcon.Wpf package is properly installed and referenced
2. SystemTrayService compiles and implements all required functionality
3. NotifyIcon is properly initialized and disposed
4. Basic application icon appears in system tray
5. Context menu contains essential controls
6. Tooltip displays basic status information
7. Service implements IDisposable pattern correctly
8. Resource cleanup occurs properly on disposal
</verification>

<success_criteria>
- H.NotifyIcon.Wpf package provides modern system tray integration
- SystemTrayService implements essential tray functionality
- Basic icon display and context menu work correctly
- Resource management follows best practices
- Foundation is ready for enhanced functionality in later plans
- Service is properly structured for dependency injection
</success_criteria>

<output>
After completion, create `.planning/phases/02-windows-integration/02-03-SUMMARY.md`
</output>