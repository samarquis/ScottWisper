---
phase: 02-windows-integration
plan: 02
type: execute
wave: 1
depends_on: ["01-core-technology-validation", "02-windows-integration-01"]
files_modified: [ScottWisper.csproj, SystemTrayService.cs]
autonomous: true
must_haves:
  truths:
    - "System tray integration is implemented with basic functionality"
    - "Application icon appears in system tray when running"
    - "Context menu provides essential application controls"
  artifacts:
    - path: "SystemTrayService.cs"
      provides: "Core system tray functionality"
      contains: "NotifyIcon"
      min_lines: 60
  key_links:
    - from: "SystemTrayService.cs"
      to: "ScottWisper.csproj"
      via: "package reference"
      pattern: "H.NotifyIcon"
---

<objective>
Implement core system tray integration with essential functionality for background operation.

Purpose: Create the foundation for system tray presence with basic icon display and context menu controls.
Output: System tray service with NotifyIcon integration and essential menu items.
</objective>

<execution_context>
@~/.config/opencode/get-shit-done/workflows/execute-plan.md
@~/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/02-windows-integration/02-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Add H.NotifyIcon.Wpf NuGet package</name>
  <files>ScottWisper.csproj</files>
  <action>
Add system tray functionality through modern WPF NotifyIcon:
1. Add H.NotifyIcon.Wpf v2.4.1+ package reference
2. Ensure compatibility with .NET 8 and WPF
3. Configure package for Windows 10/11 compatibility
4. Update project file with proper package versioning
5. Restore packages and verify no conflicts

Package requirements:
- H.NotifyIcon.Wpf for modern WPF system tray integration
- Support for custom icons and context menus
- .NET 8 compatible version
- MIT License for commercial use
</action>
  <verify>dotnet restore succeeds and H.NotifyIcon.Wpf is properly referenced</verify>
  <done>System tray package is installed and ready for integration</done>
</task>

<task type="auto">
  <name>Implement basic SystemTrayService</name>
  <files>SystemTrayService.cs</files>
  <action>
Create core SystemTrayService.cs with essential functionality:
1. Implement service class with IDisposable pattern
2. Create notify icon with basic application icon
3. Implement essential context menu items
4. Add basic tooltip information
5. Include proper cleanup and resource management

Essential menu items:
- Start/Stop Dictation
- Settings
- Exit Application

Basic functionality:
- Icon display in system tray
- Context menu with essential controls
- Basic tooltip showing application status
</action>
  <verify>SystemTrayService compiles and provides basic tray functionality</verify>
  <done>Core system tray service is implemented with essential controls</done>
</task>

<task type="auto">
  <name>Add basic application icon</name>
  <files>SystemTrayService.cs</files>
  <action>
Create and integrate basic application icon for system tray:
1. Create simple application icon file
2. Add icon file to project resources
3. Configure icon usage in SystemTrayService
4. Test icon visibility in system tray

Icon requirements:
- Simple, recognizable design
- High visibility in system tray
- Works on both light and dark themes
</action>
  <verify>Icon displays correctly in system tray</verify>
  <done>Basic application icon provides clear visual presence</done>
</task>

</tasks>

<verification>
1. H.NotifyIcon.Wpf package is properly installed and referenced
2. SystemTrayService compiles and implements all required functionality
3. Application starts minimized to system tray without showing main window
4. System tray icon appears and responds to mouse interactions
5. Context menu provides access to all application functions
6. Status indicators change correctly based on application state
7. Application runs in background with minimal CPU/memory usage
8. Application can be fully controlled without opening main window
9. Proper cleanup occurs on application exit
</verification>

<success_criteria>
- Application runs continuously as background process with system tray presence
- Complete application control available through system tray interface
- Resource usage remains minimal during idle background operation
- Status indicators provide clear feedback about application state
- User can start/stop dictation, access settings, and exit via system tray
- Application never appears in taskbar during normal operation
- Professional icon design provides clear visual communication
- Integration with existing services (hotkey, transcription) is seamless
</success_criteria>

<output>
After completion, create `.planning/phases/02-windows-integration/02-02-SUMMARY.md`
</output>