---
phase: 02-windows-integration
plan: 03
type: execute
wave: 1
depends_on: ["01-core-technology-validation", "02-windows-integration-01"]
files_modified: [TextInjectionService.cs, MainWindow.xaml.cs, App.xaml.cs]
autonomous: true
must_haves:
  truths:
    - "Transcription results are injected at cursor position in active applications"
    - "Text injection works seamlessly with existing workflow"
    - "Application compatibility mapping handles common Windows applications"
    - "User feedback mechanism handles injection issues gracefully"
  artifacts:
    - path: "MainWindow.xaml.cs"
      provides: "Text injection integration with transcription results"
      contains: "InjectText"
    - path: "App.xaml.cs"
      provides: "Service registration and initialization"
      contains: "TextInjectionService"
  key_links:
    - from: "MainWindow.xaml.cs"
      to: "TextInjectionService.cs"
      via: "service injection"
      pattern: "TextInjectionService"
    - from: "App.xaml.cs"
      to: "TextInjectionService.cs"
      via: "dependency injection"
      pattern: "services.AddTransient"
---

<objective>
Integrate universal text injection with existing transcription workflow and ensure compatibility across Windows applications.

Purpose: Connect TextInjectionService to the transcription pipeline and implement application compatibility for professional dictation workflows.
Output: Seamless text injection integration with real-world application compatibility and user feedback.
</objective>

<execution_context>
@~/.config/opencode/get-shit-done/workflows/execute-plan.md
@~/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/02-windows-integration/02-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Integrate text injection with transcription workflow</name>
  <files>MainWindow.xaml.cs, App.xaml.cs</files>
  <action>
Integrate TextInjectionService into the existing transcription workflow:
1. Register TextInjectionService in dependency injection container
2. Modify transcription completion handler to use text injection
3. Replace current display method with universal injection
4. Add configuration for injection method selection
5. Implement error recovery for injection failures
6. Add logging for injection success/failure tracking
7. Test integration with existing hotkey and transcription services

Integration points:
- Connect to WhisperService transcription completion
- Handle both real-time and final transcription results
- Maintain existing UI feedback while adding injection
- Ensure no interference with current audio capture
</action>
  <verify>Transcription results are injected at cursor position in active applications</verify>
  <done>Text injection is seamlessly integrated into the dictation workflow</done>
</task>

<task type="auto">
  <name>Implement application compatibility testing</name>
  <files>TextInjectionService.cs, MainWindow.xaml.cs</files>
  <action>
Add application compatibility and testing features:
1. Implement application detection and compatibility mapping
2. Add special handling for common applications (browsers, IDEs, Office)
3. Create test methods for injection verification
4. Add user feedback mechanism for injection issues
5. Implement automatic fallback switching
6. Add performance monitoring for injection latency
7. Create debug mode for troubleshooting injection issues

Target applications for compatibility:
- Web browsers (Chrome, Edge, Firefox)
- Development tools (Visual Studio, VS Code)
- Office applications (Word, Outlook, Teams)
- Text editors (Notepad++, Sublime Text)
- Communication tools (Slack, Discord)
</action>
  <verify>Text injection works reliably across target Windows applications</verify>
  <done>Application compatibility ensures universal text injection capability</done>
</task>

</tasks>

<verification>
1. TextInjectionService is properly registered in dependency injection
2. Transcription completion handler triggers text injection
3. Text appears at exact cursor position in active applications
4. Application detection and compatibility mapping works correctly
5. Fallback mechanisms activate when primary method fails
6. Special characters (newlines, tabs) are injected correctly
7. User feedback mechanism handles injection issues gracefully
8. Performance monitoring shows acceptable injection latency
9. Debug mode provides useful troubleshooting information
</verification>

<success_criteria>
- Universal text injection works across Windows applications without configuration
- Text appears at exact cursor position where user would type
- Multiple fallback mechanisms handle permission restrictions and edge cases
- Integration with existing transcription pipeline is transparent to user
- Performance is acceptable with injection latency under 50ms
- Application compatibility covers professional workflow scenarios
- User feedback system provides helpful information for issues
</success_criteria>

<output>
After completion, create `.planning/phases/02-windows-integration/02-02-SUMMARY.md`
</output>