<Window x:Class="WhisperKey.UI.FirstTimeSetupWizard"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Welcome to WhisperKey" 
        Height="500" Width="600"
        WindowStartupLocation="CenterScreen"
        ResizeMode="NoResize"
        Background="White">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        
        <!-- Header -->
        <Border Grid.Row="0" Background="#2196F3" Padding="20">
            <StackPanel>
                <TextBlock Text="Welcome to WhisperKey" 
                          FontSize="24" FontWeight="Bold" Foreground="White"/>
                <TextBlock Text="Let's get you set up in just a few steps" 
                          FontSize="14" Foreground="White" Opacity="0.9" Margin="0,4,0,0"/>
            </StackPanel>
        </Border>
        
        <!-- Content -->
        <Grid Grid.Row="1" Margin="24">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>
            
            <!-- Step indicator -->
            <StackPanel Grid.Row="0" Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,0,0,20">
                <Ellipse Width="12" Height="12" Fill="#2196F3" x:Name="Step1Indicator"/>
                <Rectangle Width="40" Height="2" Fill="#CCCCCC" Margin="4,0"/>
                <Ellipse Width="12" Height="12" Fill="#CCCCCC" x:Name="Step2Indicator"/>
                <Rectangle Width="40" Height="2" Fill="#CCCCCC" Margin="4,0"/>
                <Ellipse Width="12" Height="12" Fill="#CCCCCC" x:Name="Step3Indicator"/>
            </StackPanel>
            
            <!-- Step 1: API Key (Optional for Cloud, Skip for Local) -->
            <StackPanel Grid.Row="1" x:Name="Step1Panel" Visibility="Visible">
                <TextBlock Text="Step 1: Configure Transcription (Optional)" FontSize="18" FontWeight="SemiBold" Margin="0,0,0,16"/>
                
                <Border Background="#E8F5E9" BorderBrush="#4CAF50" BorderThickness="1" CornerRadius="4" Padding="12" Margin="0,0,0,16">
                    <StackPanel>
                        <TextBlock Text="âœ“ Works Offline!" FontWeight="Bold" Foreground="#2E7D32"/>
                        <TextBlock Text="WhisperKey now uses local transcription by default. No internet connection or API key required." 
                                  TextWrapping="Wrap" Foreground="#1B5E20" Margin="0,4,0,0"/>
                    </StackPanel>
                </Border>
                
                <TextBlock Text="You can optionally add a cloud API key for potentially higher accuracy. Choose your provider:" 
                          TextWrapping="Wrap" Margin="0,0,0,16"/>
                
                <Label Content="Transcription Provider (Optional):" FontWeight="SemiBold"/>
                <ComboBox x:Name="ProviderComboBox" SelectedIndex="0" Margin="0,4,0,16">
                    <ComboBoxItem Content="Local Mode (Offline, No API Key)" Tag="local"/>
                    <ComboBoxItem Content="OpenAI (Cloud)" Tag="openai"/>
                    <ComboBoxItem Content="Azure Speech Services (Cloud)" Tag="azure"/>
                    <ComboBoxItem Content="Google Cloud Speech (Cloud)" Tag="google"/>
                </ComboBox>
                
                <Label Content="API Key (Optional - for cloud mode only):" FontWeight="SemiBold"/>
                <PasswordBox x:Name="ApiKeyPasswordBox" Margin="0,4,0,8"/>
                <TextBlock Text="Leave blank to use offline local transcription. API key is stored securely on your computer and never shared." 
                          FontSize="11" Foreground="Gray" FontStyle="Italic" TextWrapping="Wrap"/>
                
                <TextBlock x:Name="ApiKeyValidationText" Text="" Foreground="Red" Margin="0,8,0,0" TextWrapping="Wrap"/>
            </StackPanel>
            
            <!-- Step 2: Microphone Test -->
            <StackPanel Grid.Row="1" x:Name="Step2Panel" Visibility="Collapsed">
                <TextBlock Text="Step 2: Test Your Microphone" FontSize="18" FontWeight="SemiBold" Margin="0,0,0,16"/>
                
                <TextBlock Text="Let's make sure your microphone is working properly." 
                          TextWrapping="Wrap" Margin="0,0,0,16"/>
                
                <Border Background="#F5F5F5" CornerRadius="8" Padding="16" Margin="0,0,0,16">
                    <StackPanel>
                        <TextBlock Text="Select your microphone:" FontWeight="SemiBold" Margin="0,0,0,8"/>
                        <ComboBox x:Name="MicrophoneComboBox" Margin="0,0,0,16"/>
                        
                        <TextBlock Text="Click the button below and speak a few words:" Margin="0,0,0,8"/>
                        <Button x:Name="TestMicrophoneButton" Content="ðŸŽ¤ Test Microphone" Width="150" Height="36" 
                                Click="TestMicrophoneButton_Click" HorizontalAlignment="Left"/>
                        
                        <ProgressBar x:Name="AudioLevelProgressBar" Height="20" Margin="0,16,0,0" Maximum="100" Value="0"/>
                        <TextBlock x:Name="MicrophoneStatusText" Text="Click 'Test Microphone' to begin" 
                                  Margin="0,8,0,0" Foreground="Gray" FontStyle="Italic"/>
                    </StackPanel>
                </Border>
                
                <TextBlock x:Name="MicrophoneValidationText" Text="" Foreground="Red" TextWrapping="Wrap"/>
            </StackPanel>
            
            <!-- Step 3: Complete -->
            <StackPanel Grid.Row="1" x:Name="Step3Panel" Visibility="Collapsed" HorizontalAlignment="Center">
                <TextBlock Text="You're All Set!" FontSize="24" FontWeight="Bold" Margin="0,0,0,16" HorizontalAlignment="Center"/>
                
                <TextBlock Text="âœ“ Local transcription enabled (offline mode)" FontSize="14" Margin="0,4,0,0" Foreground="Green"/>
                <TextBlock Text="âœ“ Microphone tested" FontSize="14" Margin="0,4,0,0" Foreground="Green"/>
                <TextBlock Text="âœ“ Ready to dictate" FontSize="14" Margin="0,4,0,24" Foreground="Green"/>
                
                <TextBlock Text="Quick Start Guide:" FontWeight="SemiBold" Margin="0,0,0,8"/>
                <TextBlock TextWrapping="Wrap" Margin="0,0,0,4">
                    <Run Text="â€¢ Press "/><Run Text="Ctrl+Alt+V" FontWeight="Bold"/><Run Text=" to start/stop dictation"/>
                </TextBlock>
                <TextBlock TextWrapping="Wrap" Margin="0,0,0,4">
                    <Run Text="â€¢ Click the "/><Run Text="tray icon" FontWeight="Bold"/><Run Text=" to access settings"/>
                </TextBlock>
                <TextBlock TextWrapping="Wrap" Margin="0,0,0,4">
                    <Run Text="â€¢ Right-click for more options"/>
                </TextBlock>
                
                <CheckBox x:Name="ShowOnStartupCheckBox" Content="Show this wizard on startup (uncheck to skip next time)" 
                         IsChecked="False" Margin="0,24,0,0"/>
            </StackPanel>
        </Grid>
        
        <!-- Footer with buttons -->
        <Border Grid.Row="2" BorderBrush="#E0E0E0" BorderThickness="0,1,0,0" Padding="16">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <Button x:Name="BackButton" Grid.Column="0" Content="Back" Width="80" Height="32" 
                        Click="BackButton_Click" IsEnabled="False"/>
                
                <Button x:Name="NextButton" Grid.Column="2" Content="Next" Width="80" Height="32" 
                        Background="#2196F3" Foreground="White" FontWeight="SemiBold"
                        Click="NextButton_Click"/>
                
                <Button x:Name="FinishButton" Grid.Column="2" Content="Finish" Width="80" Height="32" 
                        Background="#4CAF50" Foreground="White" FontWeight="SemiBold"
                        Click="FinishButton_Click" Visibility="Collapsed"/>
            </Grid>
        </Border>
    </Grid>
</Window>
