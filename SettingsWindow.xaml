<Window x:Class="WhisperKey.SettingsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        Title="WhisperKey Settings" Height="600" Width="800"
        WindowStartupLocation="CenterScreen"
        ResizeMode="CanResize"
        MinHeight="500" MinWidth="600">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <Border Grid.Row="0" Background="#FF2D2D30" Padding="16,12">
            <StackPanel Orientation="Horizontal">
                <TextBlock Text="ðŸŽ¤" FontSize="24" Margin="0,0,12,0" VerticalAlignment="Center"/>
                <TextBlock Text="WhisperKey Settings" FontSize="20" FontWeight="SemiBold" 
                           Foreground="White" VerticalAlignment="Center"/>
            </StackPanel>
        </Border>

        <!-- Main Content -->
        <TabControl Grid.Row="1" Margin="16,16,16,8" Background="Transparent"
                    AutomationProperties.Name="Settings Categories"
                    AutomationProperties.HelpText="Tab control for navigating different settings categories">
            
            <!-- General Settings Tab -->
            <TabItem Header="General">
                <Grid Margin="16,16">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    
                    <!-- Startup Options -->
                    <GroupBox Grid.Row="0" Header="Startup Options" Margin="0,0,0,12" Padding="12">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            
                            <CheckBox x:Name="StartWithWindowsCheckBox" Grid.Row="0" Grid.Column="0" 
                                      Content="Start with Windows" VerticalAlignment="Center" 
                                      Margin="0,0,0,8" Checked="StartWithWindows_Checked"/>
                            
                            <CheckBox x:Name="StartMinimizedCheckBox" Grid.Row="0" Grid.Column="1" 
                                      Content="Start minimized" VerticalAlignment="Center" 
                                      Margin="20,0,0,8" Checked="StartMinimized_Checked"/>
                            
                            <CheckBox x:Name="CheckForUpdatesCheckBox" Grid.Row="1" Grid.Column="0" 
                                      Content="Check for updates on startup" VerticalAlignment="Center" 
                                      Margin="0,8,0,0" Checked="CheckForUpdates_Checked"/>
                            
                            <CheckBox x:Name="AutoStartDictationCheckBox" Grid.Row="1" Grid.Column="1" 
                                      Content="Auto-start dictation" VerticalAlignment="Center" 
                                      Margin="20,8,0,0" Checked="AutoStartDictation_Checked"/>
                            
                            <StackPanel Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="2" Orientation="Horizontal" Margin="0,12,0,0">
                                <Label Content="Startup delay:" VerticalAlignment="Center" Margin="0,0,8,0"/>
                                <Slider x:Name="StartupDelaySlider" Minimum="0" Maximum="30" Value="3" 
                                         Width="120" ValueChanged="StartupDelay_ValueChanged"/>
                                <TextBlock x:Name="StartupDelayText" Text="3 seconds" VerticalAlignment="Center" Margin="8,0,0,0"/>
                            </StackPanel>
                        </Grid>
                    </GroupBox>
                    
                    <!-- Update Settings -->
                    <GroupBox Grid.Row="1" Header="Update Settings" Margin="0,0,0,12" Padding="12">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            
                            <CheckBox x:Name="AutoUpdateCheckBox" Grid.Row="0" Grid.Column="0" 
                                      Content="Automatic updates" VerticalAlignment="Center" 
                                      Margin="0,0,0,8" Checked="AutoUpdate_Checked"/>
                            
                            <CheckBox x:Name="BetaUpdatesCheckBox" Grid.Row="0" Grid.Column="1" 
                                      Content="Include beta updates" VerticalAlignment="Center" 
                                      Margin="20,0,0,8" Checked="BetaUpdates_Checked"/>
                            
                            <StackPanel Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="2" Orientation="Horizontal">
                                <Button x:Name="CheckUpdatesButton" Content="Check for Updates" Width="140" 
                                        Margin="0,0,8,0" Click="CheckUpdates_Click"/>
                                <Button x:Name="UpdateHistoryButton" Content="Update History" Width="140" 
                                        Margin="0,0,8,0" Click="UpdateHistory_Click"/>
                            </StackPanel>
                            
                            <TextBlock x:Name="CurrentVersionText" Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="2" 
                                       Text="Current version: 1.0.0.0" VerticalAlignment="Center" 
                                       Margin="0,12,0,0" FontWeight="Bold"/>
                        </Grid>
                    </GroupBox>
                    
                    <!-- Application Behavior -->
                    <GroupBox Grid.Row="2" Header="Application Behavior" Margin="0,0,0,12" Padding="12">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            
                            <CheckBox x:Name="SingleInstanceCheckBox" Grid.Row="0" Grid.Column="0" 
                                      Content="Allow only one instance" VerticalAlignment="Center" 
                                      Margin="0,0,0,8" Checked="SingleInstance_Checked"/>
                            
                            <CheckBox x:Name="MinimizeToTrayCheckBox" Grid.Row="0" Grid.Column="1" 
                                      Content="Minimize to system tray" VerticalAlignment="Center" 
                                      Margin="20,0,0,8" Checked="MinimizeToTray_Checked"/>
                            
                            <CheckBox x:Name="ShowNotificationsCheckBox" Grid.Row="1" Grid.Column="0" 
                                      Content="Show notifications" VerticalAlignment="Center" 
                                      Margin="0,8,0,0" Checked="ShowNotifications_Checked"/>
                            
                            <CheckBox x:Name="RememberWindowPositionCheckBox" Grid.Row="1" Grid.Column="1" 
                                      Content="Remember window position" VerticalAlignment="Center" 
                                      Margin="20,8,0,0" Checked="RememberWindowPosition_Checked"/>
                            
                             <StackPanel Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="2" Orientation="Horizontal" Margin="0,12,0,0">
                                 <Label Content="Theme:" VerticalAlignment="Center" Margin="0,0,8,0"/>
                                 <ComboBox x:Name="ThemeComboBox" Width="150" SelectionChanged="Theme_SelectionChanged">
                                     <ComboBoxItem Content="System Default" Tag="system"/>
                                     <ComboBoxItem Content="Light" Tag="light"/>
                                     <ComboBoxItem Content="Dark" Tag="dark"/>
                                     <ComboBoxItem Content="High Contrast" Tag="contrast"/>
                                 </ComboBox>
                             </StackPanel>
                         </Grid>
                     </GroupBox>
                     
                     <!-- Text Review Settings -->
                     <GroupBox Grid.Row="2" Header="Text Review" Margin="0,0,0,12" Padding="12">
                         <Grid>
                             <Grid.ColumnDefinitions>
                                 <ColumnDefinition Width="*"/>
                                 <ColumnDefinition Width="*"/>
                             </Grid.ColumnDefinitions>
                             <Grid.RowDefinitions>
                                 <RowDefinition Height="Auto"/>
                                 <RowDefinition Height="Auto"/>
                                 <RowDefinition Height="Auto"/>
                             </Grid.RowDefinitions>
                             
                             <CheckBox x:Name="EnableTextReviewCheckBox" Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="2"
                                       Content="Enable text review before injection (allows editing transcription)" 
                                       VerticalAlignment="Center" 
                                       Margin="0,0,0,8" Checked="EnableTextReview_Checked" Unchecked="EnableTextReview_Unchecked"/>
                             
                             <CheckBox x:Name="AutoInsertCheckBox" Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="2"
                                       Content="Auto-insert after timeout (if no user action)" 
                                       VerticalAlignment="Center" 
                                       Margin="20,8,0,8" IsEnabled="False"
                                       Checked="AutoInsert_Checked" Unchecked="AutoInsert_Unchecked"/>
                             
                             <StackPanel Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="2" Orientation="Horizontal" Margin="20,8,0,0">
                                 <Label Content="Review timeout:" VerticalAlignment="Center" Margin="0,0,8,0"/>
                                 <Slider x:Name="ReviewTimeoutSlider" Minimum="5" Maximum="120" Value="30" 
                                          Width="150" IsEnabled="False" ValueChanged="ReviewTimeout_ValueChanged"/>
                                 <TextBlock x:Name="ReviewTimeoutText" Text="30 seconds" VerticalAlignment="Center" Margin="8,0,0,0"/>
                                 <TextBlock Text="(0 to disable auto-insert)" VerticalAlignment="Center" Margin="12,0,0,0" Foreground="Gray" FontSize="12"/>
                             </StackPanel>
                         </Grid>
                     </GroupBox>
                 </Grid>
             </TabItem>
            
            <!-- Audio Device Settings Tab -->
            <TabItem Header="Audio Devices">
                <Grid Margin="16,16">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    
                    <!-- Input Device Section -->
                    <GroupBox Grid.Row="0" Header="Input Device" Margin="0,0,0,12" Padding="12">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            
                            <Label Grid.Column="0" Content="Primary Input Device:" 
                                   VerticalAlignment="Center" Margin="0,0,8,0"/>
                             <ComboBox x:Name="InputDeviceComboBox" Grid.Column="1"
                                       Width="250" Margin="0,0,8,0" SelectionChanged="InputDevice_SelectionChanged"
                                       AutomationProperties.Name="Primary Input Device"
                                       AutomationProperties.HelpText="Select your primary audio input device for recording"/>
                             <Button x:Name="TestInputDeviceButton" Grid.Column="2"
                                     Content="Test" Width="60" Click="TestInputDevice_Click"
                                     AutomationProperties.Name="Test Input Device"
                                     AutomationProperties.HelpText="Test the selected input device"/>
                        </Grid>
                    </GroupBox>

                    <!-- Output Device Section -->
                    <GroupBox Grid.Row="1" Header="Output Device" Margin="0,0,0,12" Padding="12">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            
                            <Label Grid.Column="0" Content="Primary Output Device:" 
                                   VerticalAlignment="Center" Margin="0,0,8,0"/>
                            <ComboBox x:Name="OutputDeviceComboBox" Grid.Column="1" 
                                      Width="250" Margin="0,0,8,0" SelectionChanged="OutputDevice_SelectionChanged"/>
                            <Button x:Name="TestOutputDeviceButton" Grid.Column="2" 
                                    Content="Test" Width="60" Click="TestOutputDevice_Click"/>
                        </Grid>
                    </GroupBox>

                    <!-- Advanced Device Options -->
                    <Expander Grid.Row="2" Header="Advanced Device Options" IsExpanded="False" Margin="0,0,0,0">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                        
                            <!-- Fallback Devices and Options -->
                            <GroupBox Grid.Row="0" Header="Fallback Devices and Options" Margin="0,0,0,12" Padding="12">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    
                                    <Label Grid.Row="0" Grid.Column="0" Content="Input Fallback Device:" 
                                           VerticalAlignment="Center" Margin="0,0,8,0"/>
                                    <ComboBox x:Name="FallbackInputDeviceComboBox" Grid.Row="0" Grid.Column="1" 
                                              Width="250" HorizontalAlignment="Left" SelectionChanged="FallbackInputDevice_SelectionChanged"/>
                                    
                                    <Label Grid.Row="1" Grid.Column="0" Content="Output Fallback Device:" 
                                           VerticalAlignment="Center" Margin="0,8,8,0"/>
                                    <ComboBox x:Name="FallbackOutputDeviceComboBox" Grid.Row="1" Grid.Column="1" 
                                              Width="250" HorizontalAlignment="Left" Margin="0,8,0,0" SelectionChanged="FallbackOutputDevice_SelectionChanged"/>
                                    
                                    <StackPanel Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="2" 
                                               Orientation="Horizontal" Margin="0,12,0,0">
                                        <CheckBox x:Name="AutoSwitchDevicesCheckBox" Content="Auto-switch devices" 
                                                  VerticalAlignment="Center" Margin="0,0,16,0" Checked="AutoSwitchDevices_Checked"/>
                                        <CheckBox x:Name="PreferHighQualityCheckBox" Content="Prefer high-quality devices" 
                                                  VerticalAlignment="Center" Margin="0,0,16,0" Checked="PreferHighQuality_Checked"/>
                                        <Button x:Name="RefreshDevicesButton" Content="Refresh Device List" 
                                                Width="120" Margin="0,0,8,0" Click="RefreshDevices_Click"/>
                                        <Button x:Name="TestAllDevicesButton" Content="Test All Devices" 
                                                Width="120" Margin="0,0,8,0" Click="TestAllDevices_Click"/>
                                        <TextBlock x:Name="DeviceStatusText" Text="Device status: Ready" 
                                                   VerticalAlignment="Center" Margin="8,0,0,0" Foreground="Gray"/>
                                    </StackPanel>
                                </Grid>
                            </GroupBox>

                            <!-- Device Details Panel -->
                            <GroupBox Grid.Row="1" Header="Device Details" Margin="0,0,0,12" Padding="12">
                                <ScrollViewer VerticalScrollBarVisibility="Auto">
                                    <Grid>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="*"/>
                                        </Grid.RowDefinitions>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="120"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        
                                        <Label Grid.Row="0" Grid.Column="0" Content="Device Name:"/>
                                        <TextBlock x:Name="DeviceNameText" Grid.Row="0" Grid.Column="1" 
                                                   Text="No device selected" Margin="4,2"/>
                                        
                                        <Label Grid.Row="1" Grid.Column="0" Content="Sample Rate:"/>
                                        <TextBlock x:Name="SampleRateText" Grid.Row="1" Grid.Column="1" 
                                                   Text="-" Margin="4,2"/>
                                        
                                        <Label Grid.Row="2" Grid.Column="0" Content="Channels:"/>
                                        <TextBlock x:Name="ChannelsText" Grid.Row="2" Grid.Column="1" 
                                                   Text="-" Margin="4,2"/>
                                        
                                        <Label Grid.Row="3" Grid.Column="0" Content="Status:"/>
                                        <TextBlock x:Name="DeviceStatusIndicator" Grid.Row="3" Grid.Column="1" 
                                                   Text="-" Margin="4,2"/>
                                        
                                        <Label Grid.Row="4" Grid.Column="0" Content="Last Tested:"/>
                                        <TextBlock x:Name="LastTestedText" Grid.Row="4" Grid.Column="1" 
                                                   Text="Never" Margin="4,2"/>
                                        
                                        <Label Grid.Row="5" Grid.Column="0" Content="Test Result:"/>
                                        <TextBlock x:Name="TestResultText" Grid.Row="5" Grid.Column="1" 
                                                   Text="No test performed" Margin="4,2"/>
                                        
                                        <Label Grid.Row="6" Grid.Column="0" Content="Notes:"/>
                                        <TextBlock x:Name="DeviceNotesText" Grid.Row="6" Grid.Column="1" 
                                                   Text="No notes available" Margin="4,2" TextWrapping="Wrap"/>
                                    </Grid>
                                </ScrollViewer>
                            </GroupBox>

                            <!-- Device List -->
                            <GroupBox Grid.Row="2" Header="All Audio Devices" Padding="12">
                                <DataGrid x:Name="DevicesDataGrid" AutoGenerateColumns="False"
                                          CanUserAddRows="False" CanUserDeleteRows="False"
                                          SelectionMode="Single" SelectionChanged="DevicesDataGrid_SelectionChanged"
                                          Height="150"
                                          AutomationProperties.Name="Audio Devices List"
                                          AutomationProperties.HelpText="List of all available audio devices. Use arrow keys to navigate, Enter to select."
                                          IsTabStop="True"
                                          KeyboardNavigation.TabNavigation="Once"
                                          KeyboardNavigation.DirectionalNavigation="Contained">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="Device Name" Binding="{Binding Name}" Width="200"/>
                                        <DataGridTextColumn Header="Type" Binding="{Binding DataFlow}" Width="80"/>
                                        <DataGridTextColumn Header="Status" Binding="{Binding State}" Width="80"/>
                                        <DataGridCheckBoxColumn Header="Compatible" Binding="{Binding IsCompatible}" Width="80"/>
                                        <DataGridTextColumn Header="Last Test" Binding="{Binding LastTested, StringFormat='yyyy-MM-dd HH:mm'}" Width="120"/>
                                        <DataGridCheckBoxColumn Header="Enabled" Binding="{Binding IsEnabled}" Width="70"/>
                                    </DataGrid.Columns>
                                </DataGrid>
                            </GroupBox>
                        </Grid>
                    </Expander>
                </Grid>
            </TabItem>

<!-- Transcription Settings Tab -->
<TabItem Header="Transcription">
                <Grid Margin="16,16">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    
                    <!-- Provider Settings -->
                    <GroupBox Grid.Row="0" Header="Provider Configuration" Margin="0,0,0,12" Padding="12">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            
                            <!-- Transcription Mode -->
                            <Label Grid.Row="0" Grid.Column="0" Content="Transcription Mode:" VerticalAlignment="Center" Margin="0,0,8,0" FontWeight="SemiBold"/>
                            <ComboBox x:Name="TranscriptionModeComboBox" Grid.Row="0" Grid.Column="0" 
                                      Width="200" HorizontalAlignment="Left" Margin="130,0,0,0" 
                                      SelectionChanged="TranscriptionMode_SelectionChanged"/>
                            
                            <!-- Local Provider Selection (shown only in Local mode) -->
                            <StackPanel x:Name="LocalProviderPanel" Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="2" 
                                        Orientation="Horizontal" Margin="0,8,0,0" Visibility="Collapsed">
                                <Label Content="Local Provider:" VerticalAlignment="Center" Margin="0,0,8,0" FontWeight="SemiBold"/>
                                <ComboBox x:Name="LocalProviderComboBox" Width="200" 
                                          SelectionChanged="LocalProvider_SelectionChanged"/>
                                <TextBlock x:Name="LocalProviderDescription" VerticalAlignment="Center" 
                                           Margin="12,0,0,0" Foreground="Gray" FontSize="11" 
                                           TextWrapping="Wrap" MaxWidth="300"/>
                            </StackPanel>
                            
                            <!-- Cloud Provider (shown only in Cloud mode) -->
                            <StackPanel x:Name="CloudProviderPanel" Grid.Row="2" Grid.Column="0" Orientation="Horizontal" Margin="0,8,0,0">
                                <Label Content="Cloud Provider:" VerticalAlignment="Center" Margin="0,0,8,0"/>
                                <ComboBox x:Name="ProviderComboBox" Width="200" 
                                          SelectionChanged="Provider_SelectionChanged"/>
                            </StackPanel>
                            
                            <Label Grid.Row="3" Grid.Column="0" Content="Model:" VerticalAlignment="Center" Margin="0,8,8,0"/>
                            <ComboBox x:Name="ModelComboBox" Grid.Row="3" Grid.Column="0" 
                                      Width="200" HorizontalAlignment="Left" Margin="80,8,0,0" 
                                      SelectionChanged="Model_SelectionChanged"/>
                            
                            <Label Grid.Row="4" Grid.Column="0" Content="Language:" VerticalAlignment="Center" Margin="0,8,8,0"/>
                            <ComboBox x:Name="LanguageComboBox" Grid.Row="4" Grid.Column="0" 
                                      Width="200" HorizontalAlignment="Left" Margin="80,8,0,0" 
                                      SelectionChanged="Language_SelectionChanged"/>
                            
                            <!-- Cloud-specific settings panel -->
                            <StackPanel x:Name="CloudSettingsPanel" Grid.Row="5" Grid.Column="0" Grid.ColumnSpan="2">
                                <Label Content="Endpoint URL:" VerticalAlignment="Center" Margin="0,8,8,0"/>
                                <TextBox x:Name="ApiEndpointTextBox" Width="250" HorizontalAlignment="Left" Margin="80,0,0,0" 
                                         TextChanged="ApiEndpoint_TextChanged"/>
                                
                                <StackPanel Orientation="Horizontal" Margin="0,8,0,0">
                                    <Label Content="Request Timeout:" VerticalAlignment="Center" Margin="0,0,8,0"/>
                                    <TextBox x:Name="ApiTimeoutTextBox" Text="30" Width="60" 
                                             TextChanged="ApiTimeout_TextChanged"/>
                                    <TextBlock Text="seconds" VerticalAlignment="Center" Margin="8,0,0,0"/>
                                </StackPanel>
                            </StackPanel>
                            
                            <Label Grid.Row="2" Grid.Column="1" Content="API Key:" VerticalAlignment="Center" Margin="20,0,8,0"/>
                            <PasswordBox x:Name="ApiKeyPasswordBox" Grid.Row="2" Grid.Column="1" 
                                         Width="250" HorizontalAlignment="Left" Margin="70,0,0,0" 
                                         PasswordChanged="ApiKey_PasswordChanged"/>
                            
                            <Button x:Name="TestApiKeyButton" Grid.Row="3" Grid.Column="1" 
                                    Content="Test API Key" Width="120" HorizontalAlignment="Left" 
                                    Margin="70,8,0,0" Click="TestApiKey_Click"/>
                            
                            <Button x:Name="ValidateEndpointButton" Grid.Row="5" Grid.Column="1" 
                                    Content="Validate Endpoint" Width="120" HorizontalAlignment="Left" 
                                    Margin="20,8,0,0" Click="ValidateEndpoint_Click" Visibility="Collapsed"/>
                            
                            <TextBlock x:Name="ApiStatusText" Grid.Row="4" Grid.Column="1" 
                                       Text="API status: Not tested" VerticalAlignment="Center" 
                                       Margin="70,8,0,0" Foreground="Gray"/>
                            
                            <StackPanel x:Name="ProxyPanel" Grid.Row="6" Grid.Column="1" Orientation="Horizontal" Margin="20,8,0,0">
                                <CheckBox x:Name="UseProxyCheckBox" Content="Use proxy" VerticalAlignment="Center" Checked="UseProxy_Checked"/>
                            </StackPanel>
                        </Grid>
                    </GroupBox>

                    <!-- Advanced Transcription Settings -->
                    <GroupBox Grid.Row="1" Header="Advanced Settings" Margin="0,0,0,12" Padding="12">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            
                            <StackPanel Grid.Row="0" Grid.Column="0" Orientation="Horizontal" Margin="0,0,0,8">
                                <CheckBox x:Name="EnableAutoPunctuationCheckBox" Content="Auto-punctuation" 
                                          VerticalAlignment="Center" Margin="0,0,16,0" Checked="EnableAutoPunctuation_Checked"/>
                                <CheckBox x:Name="EnableRealTimeTranscriptionCheckBox" Content="Real-time transcription" 
                                          VerticalAlignment="Center" Checked="EnableRealTimeTranscription_Checked"/>
                            </StackPanel>
                            
                            <StackPanel Grid.Row="0" Grid.Column="1" Orientation="Horizontal" Margin="20,0,0,8">
                                <CheckBox x:Name="EnableProfanityFilterCheckBox" Content="Profanity filter" 
                                          VerticalAlignment="Center" Margin="0,0,16,0" Checked="EnableProfanityFilter_Checked"/>
                                <CheckBox x:Name="EnableTimestampsCheckBox" Content="Include timestamps" 
                                          VerticalAlignment="Center" Checked="EnableTimestamps_Checked"/>
                            </StackPanel>
                            
                            <Label Grid.Row="1" Grid.Column="0" Content="Confidence Threshold:" VerticalAlignment="Center" Margin="0,8,8,0"/>
                            <Slider x:Name="ConfidenceThresholdSlider" Grid.Row="1" Grid.Column="0" 
                                     Minimum="0" Maximum="100" Value="80" Width="200" 
                                     HorizontalAlignment="Left" Margin="140,8,0,0" 
                                     ValueChanged="ConfidenceThreshold_ValueChanged"/>
                            <TextBlock x:Name="ConfidenceThresholdText" Grid.Row="1" Grid.Column="0" 
                                       Text="80%" VerticalAlignment="Center" Margin="350,8,0,0"/>
                            
                            <Label Grid.Row="2" Grid.Column="0" Content="Max Recording Duration:" VerticalAlignment="Center" Margin="0,8,8,0"/>
                            <StackPanel Grid.Row="2" Grid.Column="0" Orientation="Horizontal" Margin="170,8,0,0">
                                <TextBox x:Name="MaxDurationTextBox" Text="30" Width="60" 
                                         TextChanged="MaxDuration_TextChanged"/>
                                <TextBlock Text="seconds" VerticalAlignment="Center" Margin="8,0,0,0"/>
                            </StackPanel>
                        </Grid>
                    </GroupBox>

                    <!-- Usage Statistics -->
                    <GroupBox Grid.Row="2" Header="Usage Statistics" Margin="0,0,0,12" Padding="12">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            
                            <Label Grid.Row="0" Grid.Column="0" Content="Total Requests:"/>
                            <TextBlock x:Name="TotalRequestsText" Grid.Row="0" Grid.Column="1" 
                                       Text="0" FontWeight="Bold" Margin="4,2"/>
                            
                            <Label Grid.Row="1" Grid.Column="0" Content="Total Minutes:"/>
                            <TextBlock x:Name="TotalMinutesText" Grid.Row="1" Grid.Column="1" 
                                       Text="0.0" FontWeight="Bold" Margin="4,2"/>
                            
                            <Label Grid.Row="2" Grid.Column="0" Content="Current Month Usage:"/>
                            <TextBlock x:Name="CurrentMonthUsageText" Grid.Row="2" Grid.Column="1" 
                                       Text="0.0 minutes" FontWeight="Bold" Margin="4,2"/>
                            
                            <Label Grid.Row="3" Grid.Column="0" Content="Usage Limit Progress:"/>
                            <StackPanel Grid.Row="4" Grid.Column="0" Grid.ColumnSpan="2">
                                <ProgressBar x:Name="UsageLimitProgressBar" Height="20" Margin="0,4,0,8"/>
                                <TextBlock x:Name="UsageLimitTextBlock" Text="0 / 1000 (0%)" Margin="0,0,0,12"/>
                            </StackPanel>
                            
                            <Label Grid.Row="5" Grid.Column="0" Content="Request Timeout:"/>
                            <TextBlock x:Name="TimeoutValueTextBlock" Grid.Row="5" Grid.Column="1" 
                                       Text="30 seconds" FontWeight="Bold" Margin="4,2"/>
                            
                            <Button x:Name="ResetUsageButton" Grid.Row="3" Grid.Column="0" 
                                    Content="Reset Usage Statistics" Width="150" HorizontalAlignment="Left" 
                                    Margin="0,12,0,0" Click="ResetUsage_Click"/>
                        </Grid>
                    </GroupBox>
                    
                    <!-- API Tier Information -->
                    <GroupBox Grid.Row="3" Header="API Tier Information" Margin="0,0,0,12" Padding="12">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            
                            <Label Grid.Row="0" Grid.Column="0" Content="Current Tier:"/>
                            <TextBlock x:Name="CurrentTierText" Grid.Row="0" Grid.Column="1" 
                                       Text="Free" FontWeight="Bold" Margin="4,2"/>
                            
                            <Label Grid.Row="1" Grid.Column="0" Content="Monthly Limit:"/>
                            <TextBlock x:Name="MonthlyLimitText" Grid.Row="1" Grid.Column="1" 
                                       Text="1000 minutes" FontWeight="Bold" Margin="4,2"/>
                            
                            <Label Grid.Row="2" Grid.Column="0" Content="Remaining This Month:"/>
                            <TextBlock x:Name="RemainingMinutesText" Grid.Row="2" Grid.Column="1" 
                                       Text="1000 minutes" FontWeight="Bold" Margin="4,2"/>
                            
                            <Label Grid.Row="3" Grid.Column="0" Content="Next Reset Date:"/>
                            <TextBlock x:Name="NextResetDateText" Grid.Row="3" Grid.Column="1" 
                                       Text="2026-02-01" FontWeight="Bold" Margin="4,2"/>
                            
                            <Button x:Name="UpgradeTierButton" Grid.Row="0" Grid.Column="1" 
                                    Content="Upgrade Tier" Width="120" HorizontalAlignment="Right" 
                                    Margin="0,0,0,0" Click="UpgradeTier_Click"/>
                        </Grid>
                    </GroupBox>
                </Grid>
            </TabItem>

            <!-- Hotkey Settings Tab -->
            <TabItem Header="Hotkeys">
                <Grid Margin="16,16">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    
                    <!-- Main Hotkeys - Always Visible -->
                    <GroupBox Grid.Row="0" Header="Main Hotkeys" Margin="0,0,0,12" Padding="12">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="200"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            
                            <Label Grid.Row="0" Grid.Column="0" Content="Toggle Recording:" VerticalAlignment="Center"/>
                            <StackPanel Grid.Row="0" Grid.Column="1" Orientation="Horizontal">
                                <TextBox x:Name="ToggleRecordingHotkeyTextBox" Text="Ctrl+Alt+V" 
                                         IsReadOnly="True" Width="150" VerticalAlignment="Center" Margin="0,0,8,0"/>
                                <Button x:Name="SetToggleRecordingHotkeyButton" Content="Set" Width="60" 
                                        Margin="0,0,8,0" Click="SetToggleRecordingHotkey_Click"/>
                                <Button x:Name="ResetToggleRecordingHotkeyButton" Content="Reset" Width="60" 
                                        Margin="0,0,8,0" Click="ResetToggleRecordingHotkey_Click"/>
                            </StackPanel>
                            
                            <Label Grid.Row="1" Grid.Column="0" Content="Show Settings:" VerticalAlignment="Center" Margin="0,8,0,0"/>
                            <StackPanel Grid.Row="1" Grid.Column="1" Orientation="Horizontal" Margin="0,8,0,0">
                                <TextBox x:Name="ShowSettingsHotkeyTextBox" Text="Ctrl+Alt+S" 
                                         IsReadOnly="True" Width="150" VerticalAlignment="Center" Margin="0,0,8,0"/>
                                <Button x:Name="SetShowSettingsHotkeyButton" Content="Set" Width="60" 
                                        Margin="0,0,8,0" Click="SetShowSettingsHotkey_Click"/>
                                <Button x:Name="ResetShowSettingsHotkeyButton" Content="Reset" Width="60" 
                                        Margin="0,0,8,0" Click="ResetShowSettingsHotkey_Click"/>
                            </StackPanel>
                            
                            <TextBlock x:Name="HotkeyStatusText" Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="2" 
                                       Text="Hotkey status messages appear here" 
                                       VerticalAlignment="Center" Margin="0,8,0,0" Foreground="Gray"/>
                        </Grid>
                    </GroupBox>
                    
                    <!-- Profile Management - Collapsible -->
                    <Expander Grid.Row="1" Header="Profile Management" Margin="0,0,0,12" IsExpanded="False">
                        <Grid Margin="12">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="150"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            
                            <Label Grid.Row="0" Grid.Column="0" Content="Current Profile:" VerticalAlignment="Center"/>
                            <ComboBox x:Name="ProfileComboBox" Grid.Row="0" Grid.Column="1" 
                                      Width="250" HorizontalAlignment="Left" Margin="0,0,8,0" 
                                      SelectionChanged="Profile_SelectionChanged"/>
                            <Button x:Name="NewProfileButton" Grid.Row="0" Grid.Column="2" 
                                    Content="New" Width="60" Margin="0,0,8,0" Click="NewProfile_Click"/>
                            <Button x:Name="ImportExportButton" Grid.Row="0" Grid.Column="3" 
                                    Content="Import/Export" Width="100" Margin="0,0,8,0" Click="ImportExport_Click"/>
                            <Button x:Name="ResetToDefaultButton" Grid.Row="0" Grid.Column="4" 
                                    Content="Reset to Default" Width="110" Click="ResetToDefault_Click"/>
                            
                            <TextBlock x:Name="ProfileDescriptionText" Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="5" 
                                       Text="Profile description will appear here" 
                                       VerticalAlignment="Center" Margin="0,8,0,0" Foreground="Gray" TextWrapping="Wrap"/>
                            
                            <StackPanel Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="5" Orientation="Horizontal" Margin="0,8,0,0">
                                <CheckBox x:Name="EnableConflictWarningsCheckBox" Content="Show conflict warnings" 
                                          VerticalAlignment="Center" Margin="0,0,16,0" Checked="EnableConflictWarnings_Checked"/>
                                <CheckBox x:Name="EnableAccessibilityOptionsCheckBox" Content="Accessibility mode" 
                                          VerticalAlignment="Center" Margin="0,0,16,0" Checked="EnableAccessibilityOptions_Checked"/>
                                <CheckBox x:Name="EnableKeyboardLayoutAwarenessCheckBox" Content="Keyboard layout awareness" 
                                          VerticalAlignment="Center" Checked="EnableKeyboardLayoutAwareness_Checked"/>
                            </StackPanel>
                        </Grid>
                    </Expander>

                    <!-- Hotkey Configuration - Expanded by default -->
                    <Expander Grid.Row="2" Header="Hotkey Configuration" Margin="0,0,0,12" IsExpanded="True">
                        <Grid Margin="12">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>
                            
                            <!-- Hotkey List Header -->
                            <Grid Grid.Row="0" Margin="0,0,0,8">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="30"/>
                                    <ColumnDefinition Width="180"/>
                                    <ColumnDefinition Width="150"/>
                                    <ColumnDefinition Width="200"/>
                                    <ColumnDefinition Width="80"/>
                                    <ColumnDefinition Width="60"/>
                                    <ColumnDefinition Width="60"/>
                                </Grid.ColumnDefinitions>
                                
                                <Label Grid.Column="0" Content="â˜‘" HorizontalAlignment="Center" FontWeight="Bold"/>
                                <Label Grid.Column="1" Content="Action Name" FontWeight="Bold"/>
                                <Label Grid.Column="2" Content="Hotkey" FontWeight="Bold"/>
                                <Label Grid.Column="3" Content="Description" FontWeight="Bold"/>
                                <Label Grid.Column="4" Content="Emergency" FontWeight="Bold"/>
                                <Label Grid.Column="5" Content="Edit" FontWeight="Bold"/>
                                <Label Grid.Column="6" Content="Test" FontWeight="Bold"/>
                            </Grid>
                            
                            <!-- Hotkey List -->
                            <DataGrid x:Name="HotkeysDataGrid" Grid.Row="1" AutoGenerateColumns="False"
                                      CanUserAddRows="False" CanUserDeleteRows="False"
                                      SelectionMode="Single" Height="200"
                                      SelectionChanged="HotkeysDataGrid_SelectionChanged"
                                      AutomationProperties.Name="Hotkey Configuration List"
                                      AutomationProperties.HelpText="List of configurable hotkey actions. Use arrow keys to navigate."
                                      IsTabStop="True"
                                      KeyboardNavigation.TabNavigation="Once"
                                      KeyboardNavigation.DirectionalNavigation="Contained">
                                <DataGrid.Columns>
                                    <DataGridCheckBoxColumn Header="â˜‘" Binding="{Binding IsEnabled}" Width="30"/>
                                    <DataGridTextColumn Header="Name" Binding="{Binding Name}" Width="180"/>
                                    <DataGridTextColumn Header="Hotkey" Binding="{Binding Combination}" Width="150"/>
                                    <DataGridTextColumn Header="Description" Binding="{Binding Description}" Width="200"/>
                                    <DataGridCheckBoxColumn Header="Emergency" Binding="{Binding IsEmergency}" Width="80"/>
                                    <DataGridTemplateColumn Header="Edit" Width="60">
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <Button Content="âœï¸" Width="50" Height="20" 
                                                        Click="EditHotkey_Click" Tag="{Binding Id}"/>
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>
                                    <DataGridTemplateColumn Header="Test" Width="60">
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <Button Content="â–¶ï¸" Width="50" Height="20" 
                                                        Click="TestHotkey_Click" Tag="{Binding Id}"/>
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>
                                </DataGrid.Columns>
                            </DataGrid>
                        </Grid>
                    </Expander>

                    <!-- Quick Recording - Simplified -->
                    <Expander Grid.Row="3" Header="Quick Recording" Margin="0,0,0,12" IsExpanded="False">
                        <Grid Margin="12">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="120"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            
                            <Label Grid.Row="0" Grid.Column="0" Content="Action Name:" VerticalAlignment="Center"/>
                            <TextBox x:Name="HotkeyNameTextBox" Grid.Row="0" Grid.Column="1" 
                                     Text="New Action" Margin="0,0,8,0" VerticalAlignment="Center"/>
                            
                            <StackPanel Grid.Row="0" Grid.Column="2" Orientation="Horizontal" VerticalAlignment="Center">
                                <TextBox x:Name="HotkeyRecordingTextBox" Text="Press keys..." 
                                         IsReadOnly="True" Width="120" Margin="0,0,8,0" VerticalAlignment="Center"
                                         ToolTip="Click Record, press your hotkey combination, then click Add"/>
                                <Button x:Name="StartRecordingButton" Content="ðŸŽ¤ Record" Width="80" 
                                        Margin="0,0,8,0" Click="StartRecording_Click"/>
                                <CheckBox x:Name="IsEmergencyCheckBox" Content="Emergency" VerticalAlignment="Center" Margin="0,0,8,0"/>
                            </StackPanel>
                            
                            <Button x:Name="AddHotkeyButton" Grid.Row="0" Grid.Column="3" 
                                    Content="Add" Width="60" Click="AddHotkey_Click" VerticalAlignment="Center"/>
                        </Grid>
                    </Expander>

                    <!-- Conflicts - Auto-detected -->
                    <Expander Grid.Row="4" Header="Conflicts (Auto-Detected)" Margin="0,0,0,12" IsExpanded="False">
                        <Grid Margin="12">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>
                            
                            <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,8">
                                <Button x:Name="AutoResolveButton" Content="ðŸ”§ Auto-Resolve All" Width="140" 
                                        Click="AutoResolve_Click"/>
                                <TextBlock x:Name="ConflictStatusText" VerticalAlignment="Center" Margin="16,0,0,0" Foreground="Gray"/>
                            </StackPanel>
                            
                            <DataGrid x:Name="ConflictsDataGrid" Grid.Row="1" AutoGenerateColumns="False"
                                      CanUserAddRows="False" CanUserDeleteRows="False"
                                      SelectionMode="Single" Height="120"
                                      AutomationProperties.Name="Hotkey Conflicts List"
                                      AutomationProperties.HelpText="List of detected hotkey conflicts with other applications."
                                      IsTabStop="True"
                                      KeyboardNavigation.TabNavigation="Once"
                                      KeyboardNavigation.DirectionalNavigation="Contained">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="Conflicting Hotkey" Binding="{Binding ConflictingHotkey}" Width="150"/>
                                    <DataGridTextColumn Header="Application" Binding="{Binding ConflictingApplication}" Width="150"/>
                                    <DataGridTextColumn Header="Type" Binding="{Binding ConflictType}" Width="100"/>
                                    <DataGridTextColumn Header="Suggested Fix" Binding="{Binding SuggestedHotkey}" Width="150"/>
                                    <DataGridCheckBoxColumn Header="Resolvable" Binding="{Binding IsResolvable}" Width="80"/>
                                    <DataGridTemplateColumn Header="Action" Width="80">
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <Button Content="Apply Fix" Width="70" Height="20" 
                                                        Click="ApplyFix_Click" Tag="{Binding}"/>
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>
                                </DataGrid.Columns>
                            </DataGrid>
                        </Grid>
                    </Expander>
                </Grid>
            </TabItem>

<!-- Advanced Settings Tab -->
            <TabItem Header="Advanced">
                <Grid Margin="16,16">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    
                    <!-- Debug Logging -->
                    <GroupBox Grid.Row="0" Header="Debug Logging" Margin="0,0,0,12" Padding="12">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            
                            <CheckBox x:Name="EnableDebugLoggingCheckBox" Grid.Row="0" Grid.Column="0" 
                                      Content="Enable debug logging" VerticalAlignment="Center" 
                                      Margin="0,0,0,8" Checked="EnableDebugLogging_Checked"/>
                            
                            <CheckBox x:Name="EnableVerboseLoggingCheckBox" Grid.Row="0" Grid.Column="1" 
                                      Content="Verbose logging" VerticalAlignment="Center" 
                                      Margin="20,0,0,8" Checked="EnableVerboseLogging_Checked"/>
                            
                            <CheckBox x:Name="LogToFileCheckBox" Grid.Row="1" Grid.Column="0" 
                                      Content="Log to file" VerticalAlignment="Center" 
                                      Margin="0,8,0,0" Checked="LogToFile_Checked"/>
                            
                            <CheckBox x:Name="LogApiCallsCheckBox" Grid.Row="1" Grid.Column="1" 
                                      Content="Log API calls" VerticalAlignment="Center" 
                                      Margin="20,8,0,0" Checked="LogApiCalls_Checked"/>
                            
                            <StackPanel Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="2" Orientation="Horizontal" Margin="0,12,0,0">
                                <Label Content="Log level:" VerticalAlignment="Center" Margin="0,0,8,0"/>
                                <ComboBox x:Name="LogLevelComboBox" Width="120" SelectionChanged="LogLevel_SelectionChanged">
                                    <ComboBoxItem Content="Error" Tag="error"/>
                                    <ComboBoxItem Content="Warning" Tag="warning"/>
                                    <ComboBoxItem Content="Info" Tag="info"/>
                                    <ComboBoxItem Content="Debug" Tag="debug"/>
                                    <ComboBoxItem Content="Trace" Tag="trace"/>
                                </ComboBox>
                            </StackPanel>
                            
                            <StackPanel Grid.Row="3" Grid.Column="0" Grid.ColumnSpan="2" Orientation="Horizontal" Margin="0,8,0,0">
                                <Button x:Name="ViewLogsButton" Content="View Logs" Width="100" 
                                        Margin="0,0,8,0" Click="ViewLogs_Click"/>
                                <Button x:Name="ClearLogsButton" Content="Clear Logs" Width="100" 
                                        Margin="0,0,8,0" Click="ClearLogs_Click"/>
                                <Button x:Name="ExportLogsButton" Content="Export Logs" Width="100" 
                                        Margin="0,0,8,0" Click="ExportLogs_Click"/>
                                <TextBlock x:Name="LogFileSizeText" Text="Log file size: 0 KB" 
                                           VerticalAlignment="Center" Margin="16,0,0,0" Foreground="Gray"/>
                            </StackPanel>
                        </Grid>
                    </GroupBox>
                    
                    <!-- Performance Metrics -->
                    <GroupBox Grid.Row="1" Header="Performance Metrics" Margin="0,0,0,12" Padding="12">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            
                            <CheckBox x:Name="EnablePerformanceMetricsCheckBox" Grid.Row="0" Grid.Column="0" 
                                      Content="Enable performance metrics" VerticalAlignment="Center" 
                                      Margin="0,0,0,8" Checked="EnablePerformanceMetrics_Checked"/>
                            
                            <CheckBox x:Name="ShowLatencyOverlayCheckBox" Grid.Row="0" Grid.Column="1" 
                                      Content="Show latency overlay" VerticalAlignment="Center" 
                                      Margin="20,0,0,8" Checked="ShowLatencyOverlay_Checked"/>
                            
                            <StackPanel Grid.Row="1" Grid.Column="0" Orientation="Horizontal" Margin="0,8,0,0">
                                <Label Content="Metrics interval:" VerticalAlignment="Center" Margin="0,0,8,0"/>
                                <Slider x:Name="MetricsIntervalSlider" Minimum="1" Maximum="60" Value="5" 
                                         Width="120" ValueChanged="MetricsInterval_ValueChanged"/>
                                <TextBlock x:Name="MetricsIntervalText" Text="5 seconds" VerticalAlignment="Center" Margin="8,0,0,0"/>
                            </StackPanel>
                            
                            <Button x:Name="ViewMetricsButton" Grid.Row="1" Grid.Column="1" 
                                    Content="View Metrics" Width="100" HorizontalAlignment="Left" 
                                    Margin="20,8,0,0" Click="ViewMetrics_Click"/>
                            
                            <StackPanel Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="2" Orientation="Horizontal" Margin="0,12,0,0">
                                <Button x:Name="ResetMetricsButton" Content="Reset Metrics" Width="100" 
                                        Margin="0,0,8,0" Click="ResetMetrics_Click"/>
                                <Button x:Name="ExportMetricsButton" Content="Export Metrics" Width="100" 
                                        Margin="0,0,8,0" Click="ExportMetrics_Click"/>
                                <TextBlock x:Name="CpuUsageText" Text="CPU: 0%" 
                                           VerticalAlignment="Center" Margin="16,0,8,0" Foreground="Gray"/>
                                <TextBlock x:Name="MemoryUsageText" Text="Memory: 0 MB" 
                                           VerticalAlignment="Center" Margin="0,0,0,0" Foreground="Gray"/>
                            </StackPanel>
                        </Grid>
                    </GroupBox>
                    
                    <!-- Reset Options -->
                    <GroupBox Grid.Row="2" Header="Reset Options" Margin="0,0,0,12" Padding="12">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            
                            <Button x:Name="ResetAudioSettingsButton" Grid.Row="0" Grid.Column="0" 
                                    Content="Reset Audio Settings" Width="140" HorizontalAlignment="Left" 
                                    Margin="0,0,8,0" Click="ResetAudioSettings_Click"/>
                            
                            <Button x:Name="ResetHotkeySettingsButton" Grid.Row="0" Grid.Column="1" 
                                    Content="Reset Hotkey Settings" Width="140" HorizontalAlignment="Left" 
                                    Margin="20,0,0,0" Click="ResetHotkeySettings_Click"/>
                            
                            <Button x:Name="AdvancedResetUISettingsButton" Grid.Row="1" Grid.Column="0" 
                                    Content="Reset UI Settings" Width="140" HorizontalAlignment="Left" 
                                    Margin="0,8,0,0" Click="AdvancedResetUISettings_Click"/>
                            
                            <Button x:Name="AdvancedResetAPISettingsButton" Grid.Row="1" Grid.Column="1" 
                                    Content="Reset API Settings" Width="140" HorizontalAlignment="Left" 
                                    Margin="20,8,0,0" Click="AdvancedResetAPISettings_Click"/>
                            
                            <Button x:Name="AdvancedResetAllSettingsButton" Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="2" 
                                    Content="Reset ALL Settings to Defaults" Width="200" HorizontalAlignment="Left" 
                                    Margin="0,12,0,0" Click="AdvancedResetAllSettings_Click" 
                                    Background="#FFFF5252" Foreground="White"/>
                            
                            <TextBlock x:Name="ResetWarningText" Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="2" 
                                       Text="âš ï¸ Warning: Resetting all settings cannot be undone!" 
                                       VerticalAlignment="Center" Margin="220,12,0,0" Foreground="Red" FontWeight="Bold"/>
                        </Grid>
                    </GroupBox>
                </Grid>
            </TabItem>
            
            <!-- UI Settings Tab -->
            <TabItem Header="Interface">
                <Grid Margin="16,16">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    
                    <!-- Visual Feedback -->
                    <GroupBox Grid.Row="0" Header="Visual Feedback" Margin="0,0,0,12" Padding="12">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            
                            <CheckBox x:Name="ShowVisualFeedbackCheckBox" Grid.Row="0" Grid.Column="0" 
                                      Content="Show visual feedback" VerticalAlignment="Center" 
                                      Margin="0,0,0,8" Checked="ShowVisualFeedback_Checked"/>
                            
                            <CheckBox x:Name="ShowTranscriptionWindowCheckBox" Grid.Row="0" Grid.Column="1" 
                                      Content="Show transcription window" VerticalAlignment="Center" 
                                      Margin="20,0,0,8" Checked="ShowTranscriptionWindow_Checked"/>
                            
                            <CheckBox x:Name="InterfaceMinimizeToTrayCheckBox" Grid.Row="1" Grid.Column="0" 
                                      Content="Minimize to system tray" VerticalAlignment="Center" 
                                      Margin="0,8,0,0" Checked="InterfaceMinimizeToTray_Checked"/>
                            
                            <CheckBox x:Name="InterfaceStartWithWindowsCheckBox" Grid.Row="1" Grid.Column="1" 
                                      Content="Start with Windows" VerticalAlignment="Center" 
                                      Margin="20,8,0,0" Checked="InterfaceStartWithWindows_Checked"/>
                            
                            <StackPanel Grid.Row="2" Grid.Column="0" Orientation="Horizontal" Margin="0,8,0,0">
                                <Label Content="Window opacity:" VerticalAlignment="Center"/>
                                <Slider x:Name="WindowOpacitySlider" Minimum="20" Maximum="100" Value="80" 
                                         Width="120" ValueChanged="WindowOpacity_ValueChanged"/>
                                <TextBlock x:Name="WindowOpacityText" Text="80%" VerticalAlignment="Center" Margin="8,0,0,0"/>
                            </StackPanel>
                        </Grid>
                    </GroupBox>

                    <!-- Audio Feedback -->
                    <GroupBox Grid.Row="1" Header="Audio Feedback" Margin="0,0,0,12" Padding="12">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            
                            <CheckBox x:Name="EnableAudioFeedbackCheckBox" Grid.Row="0" Grid.Column="0" 
                                      Content="Enable audio feedback" VerticalAlignment="Center" 
                                      Margin="0,0,0,8" Checked="EnableAudioFeedback_Checked"/>
                            
                            <StackPanel Grid.Row="0" Grid.Column="1" Orientation="Horizontal" Margin="20,0,0,8">
                                <Label Content="Volume:" VerticalAlignment="Center"/>
                                <Slider x:Name="FeedbackVolumeSlider" Minimum="0" Maximum="100" Value="50" 
                                         Width="100" ValueChanged="FeedbackVolume_ValueChanged"/>
                                <TextBlock x:Name="FeedbackVolumeText" Text="50%" VerticalAlignment="Center" Margin="8,0,0,0"/>
                            </StackPanel>
                            
                            <Button x:Name="TestStartSoundButton" Grid.Row="1" Grid.Column="0" 
                                    Content="Test Start Sound" Width="120" HorizontalAlignment="Left" 
                                    Margin="0,8,0,0" Click="TestStartSound_Click"/>
                            
                            <Button x:Name="TestStopSoundButton" Grid.Row="1" Grid.Column="1" 
                                    Content="Test Stop Sound" Width="120" HorizontalAlignment="Left" 
                                    Margin="20,8,0,0" Click="TestStopSound_Click"/>
                        </Grid>
                    </GroupBox>

                    <!-- Advanced UI Settings -->
                    <GroupBox Grid.Row="2" Header="Advanced" Margin="0,0,0,12" Padding="12">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            
                            <Button x:Name="InterfaceResetUISettingsButton" Grid.Row="0" Grid.Column="0" 
                                    Content="Reset UI Settings" Width="140" HorizontalAlignment="Left" 
                                    Margin="0,0,8,0" Click="InterfaceResetUISettings_Click"/>
                            
                            <Button x:Name="InterfaceResetAllSettingsButton" Grid.Row="0" Grid.Column="1" 
                                    Content="Reset All Settings" Width="140" HorizontalAlignment="Left" 
                                    Margin="20,0,0,0" Click="InterfaceResetAllSettings_Click"/>
                        </Grid>
                    </GroupBox>
                </Grid>
            </TabItem>
        </TabControl>

        <!-- Footer -->
        <Border Grid.Row="2" Background="#FF2D2D30" Padding="16,12">
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                <Button x:Name="CancelButton" Content="Cancel" Width="80" Margin="0,0,8,0" 
                        Click="CancelButton_Click" Background="#FF5A5A5A" Foreground="White"/>
                <Button x:Name="ApplyButton" Content="Apply" Width="80" Margin="0,0,8,0" 
                        Click="ApplyButton_Click" Background="#FF007ACC" Foreground="White"/>
                <Button x:Name="OKButton" Content="OK" Width="80" 
                        Click="OKButton_Click" Background="#FF007ACC" Foreground="White"/>
            </StackPanel>
        </Border>
    </Grid>
</Window>